sap.ui.define(["sap/m/MessageToast","sap/ui/webc/main/TreeItem"],function(e,t){"use strict";var a=this;var n;var o;var r;var i;var s;return{onPress:function(t){e.show("Custom handler invoked.")},onAfterItemAdded:async function(e){debugger;var a=e.oSource.getParent().getParent().getParent().getParent().getParent().getParent().getParent().getParent().oContainer.getParent().getParent().getParent().getManifestObject()._oBaseUri._string;var n=e.getParameter("item");var s=e.getParameter("item").getFileName();var l=e.getParameter("item").getFileObject().type;if(!o){o=true;var c=new sap.m.Dialog({contentWidth:"40%",endButton:new sap.m.Button({text:"Cancel",press:function(e){debugger;c.close();sap.ui.getCore().byId("masterdata1::MasterDataObjectPage--fe::CustomSubSection::Attachaments").mAggregations._grid.mAggregations.content[0].mAggregations.content.mAggregations.items[0].destroyIncompleteItems();c.destroyContent();o=false}}),beginButton:new sap.m.Button({text:"Ok",press:function(e){debugger;i=e.getSource().getParent().mAggregations.content[1].mAggregations.items[0].mProperties.footerText;if(i==="Click on the folder to select path"){var t=sap.m.MessageBox.warning("No folder selected.",{title:"Warning",onClose:function(){t.close();debugger}})}else{debugger;var a=function(e){debugger;var t=e.getBindingContext().sPath;var a={mediaType:e.getMediaType(),fileName:e.getFileName(),Folder:i,IsActiveEntity:false};var n={url:"/odata/v4/my"+t+"/master_newfiles",method:"POST",headers:{"Content-type":"application/json"},data:JSON.stringify(a)};return new Promise((e,t)=>{$.ajax(n).done((t,a,n)=>{e(t.ID)}).fail(e=>{t(e)})})};a(n).then(e=>{debugger;var t=`/odata/v4/my/NewFiles(ID=${e},IsActiveEntity=false)/content`;n.setUploadUrl(t);c.close();c.destroyContent();o=false;var a=sap.ui.getCore().byId("masterdata1::MasterDataObjectPage--fe::CustomSubSection::Attachaments--uploadSet");a.setHttpRequestMethod("PUT");a.uploadItem(n)}).catch(e=>{console.log(e)});debugger}}})});var d=new sap.m.VBox({width:"100%",height:"100%"});d.addStyleClass("vboxclass");var g=new sap.m.HBox;var m=new sap.ui.core.Icon({src:r,size:"2rem",marginRight:"0.5rem"});debugger;var f=new sap.m.Text({text:s});m.addStyleClass("icon");f.addStyleClass("name");d.addItem(g);var u=new sap.m.VBox("vb1");u.addItem(new sap.ui.webc.main.Tree("treee",{itemClick:async function(e){let t=e.mParameters.item;let a="";let n=t;while(n&&n.getId()!=="treee"){let e=n.getText();a=`${e} / ${a}`;n=n.getParent()}sap.ui.getCore().byId("treee").setFooterText(a)},footerText:"Click on the folder to select path",headerText:"Folders",items:[new t("folder_1",{icon:"sap-icon://folder-full",text:"Main Floder",items:[new t("folder_1.1",{icon:"sap-icon://folder-full",text:"Attachment 1"}),new t("folder_1.2",{icon:"sap-icon://folder-full",text:"Attachment 2"}),new t("folder_1.3",{icon:"sap-icon://folder-full",text:"Attachment 3"}),new t("folder_1.4",{icon:"sap-icon://folder-full",text:"Attachment 4"}),new t("folder_1.5",{icon:"sap-icon://folder-full",text:"Attachment 5"}),new t("folder_1.6",{icon:"sap-icon://folder-full",text:"Attachment 6"}),new t("folder_1.7",{icon:"sap-icon://folder-full",text:"Attachment 7"}),new t("folder_1.8",{icon:"sap-icon://folder-full",text:"Attachment 8",additionalText:"✔️"}),new t("folder_1.9",{icon:"sap-icon://folder-full",text:"Attachment 9"}),new t("folder_1.10",{icon:"sap-icon://folder-full",text:"Attachment 10"}),new t("folder_1.11",{icon:"sap-icon://folder-full",text:"Attachment 11"}),new t("folder_1.12",{icon:"sap-icon://folder-full",text:"Attachment 12"}),new t("folder_1.13",{icon:"sap-icon://folder-full",text:"Attachment 13"}),new t("folder_1.14",{icon:"sap-icon://folder-full",text:"Attachment 14"}),new t("folder_1.15",{icon:"sap-icon://folder-full",text:"Attachment 15"})]})]}));const e="funcimport";const a=this._view.getModel().bindContext(`/${e}(...)`);debugger;var p=window.location.href;var h=p.match(/Masterdataid='([^']+)'/);var v=h?h[1]:null;const l=JSON.stringify({id:v});a.setParameter("data",l);a.setParameter("status",JSON.stringify({status:"getattachmentskey"}));await a.execute();const I=a.getBoundContext().getValue();let T=I.value;T=JSON.parse(T);var x=[];for(var w=0;w<T.length;w++){var b=T[w].Folder;var h=b.match(/\/\s*(Attachment \d+)\s*\//);if(h){x.push(h[1])}}var A="✔️";var P="❌";var C=u.mAggregations.items[0].mAggregations.items[0].mAggregations.items;for(var y=0;y<C.length;y++){var _=C[y].mProperties.text;if(x.includes(_)){C[y].setAdditionalText(A)}else{C[y].setAdditionalText(P)}}c.addContent(d);c.addContent(u);c.open()}},onUploadCompleted:function(e){debugger;var t=this.byId("uploadSet");t.removeAllIncompleteItems();t.getBinding("items").refresh()},onRemovePressed:function(e){debugger;e.preventDefault();e.getParameter("item").getBindingContext().delete()},formatThumbnailUrl:function(e){debugger;var t;switch(e){case"image/png":t="sap-icon://card";break;case"text/plain":t="sap-icon://document-text";break;case"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":t="sap-icon://excel-attachment";break;case"application/vnd.openxmlformats-officedocument.wordprocessingml.document":t="sap-icon://doc-attachment";break;case"application/pdf":t="sap-icon://pdf-attachment";break;default:t="sap-icon://attachment"}return t}}});
//# sourceMappingURL=Attachaments.js.map